#############################################################################

####### Compiler, tools and options

CXX	=	$(SYSCONF_CXX) $(QT_CXX_MT)
CXXFLAGS=	$(SYSCONF_CXXFLAGS_QTOPIA) $(SYSCONF_CXXFLAGS_QT) $(SYSCONF_CXXFLAGS) $(SYSCONF_CXXFLAGS_LIB) -DHAVE_AV_CONFIG_H -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_GNU_SOURCE
CC	=	$(SYSCONF_CC) $(QT_C_MT)
CFLAGS	=	$(SYSCONF_CFLAGS_QTOPIA) $(SYSCONF_CFLAGS) $(SYSCONF_CFLAGS_LIB) -DHAVE_AV_CONFIG_H -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -D_GNU_SOURCE
INCPATH =	-I$(MOC_DIR) -I. -I$(QPEDIR)/src/3rdparty/libraries/libavformat -I$(QPEDIR)/src/3rdparty/libraries/libavcodec
LFLAGS	=	$(SYSCONF_LFLAGS_QTOPIA) $(SYSCONF_RPATH_QTOPIA) $(SYSCONF_LFLAGS_QT) $(SYSCONF_RPATH_QT) $(SYSCONF_LFLAGS) $(QT_LFLAGS_MT)
LIBS	=	$(SUBLIBS) -lpthread -lm -lavcodec -lavformat -lqpe $(SYSCONF_LIBS_QTOPIA) $(SYSCONF_LIBS_QT) $(SYSCONF_LIBS_QTAPP)
MOC	=	$(SYSCONF_MOC)
UIC	=	$(SYSCONF_UIC)

####### Target

DESTDIR = $(QPEDIR)/plugins/codecs/
VER_MAJ = 1
VER_MIN = 0
VER_PATCH = 0
TARGET	= ffmpegplugin
TARGET1 = lib$(TARGET).so.$(VER_MAJ)

####### Files

HEADERS =	yuv2rgb.h \
		libffmpegplugin.h \
		libffmpegpluginimpl.h
SOURCES =	yuv2rgb.cpp \
		libffmpegplugin.cpp \
		libffmpegpluginimpl.cpp
OBJECTS =	$(OBJECTS_DIR)/yuv2rgb.o \
		$(OBJECTS_DIR)/libffmpegplugin.o \
		$(OBJECTS_DIR)/libffmpegpluginimpl.o
INTERFACES =    
UICDECLS =      
UICIMPLS =      
SRCMOC	=	
OBJMOC	=	


####### Implicit rules

.SUFFIXES: .cpp .cxx .cc .C .c

.cpp.o:
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<

.cxx.o:
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<

.cc.o:
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<

.C.o:
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $@ $<

.c.o:
	$(CC) -c $(CFLAGS) $(INCPATH) -o $@ $<

####### Build rules


all: $(DESTDIR)$(SYSCONF_LINK_TARGET)

$(DESTDIR)$(SYSCONF_LINK_TARGET): $(UICDECLS) $(OBJECTS) $(OBJMOC) $(SUBLIBS)
	$(SYSCONF_LINK_LIB)

moc: $(SRCMOC)

tmake:
	tmake libffmpeg.pro

clean:
	-rm -f $(OBJECTS) $(OBJMOC) $(SRCMOC) $(UICIMPLS) $(UICDECLS)
	-rm -f *~ core
	-rm -f allmoc.cpp

####### Extension Modules

listpromodules:
	@echo 

listallmodules:
	@echo 

listaddonpromodules:
	@echo 

listaddonentmodules:
	@echo 


REQUIRES=

####### Sub-libraries


###### Combined headers



####### Compile

$(OBJECTS_DIR)/yuv2rgb.o: yuv2rgb.cpp \
		yuv2rgb.h \
		yuv2rgb_arm.c
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/yuv2rgb.o yuv2rgb.cpp

$(OBJECTS_DIR)/libffmpegplugin.o: libffmpegplugin.cpp \
		libffmpegplugin.h \
		$(QPEDIR)/src/3rdparty/libraries/libavcodec/avcodec.h \
		$(QPEDIR)/src/3rdparty/libraries/libavcodec/common.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/config.h \
		$(QPEDIR)/src/3rdparty/libraries/libavcodec/fastmemcpy.h \
		$(QPEDIR)/src/3rdparty/libraries/libavcodec/bswap.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/avformat.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/avio.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/rtp.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/rtsp.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/rtspcodes.h \
		yuv2rgb.h
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/libffmpegplugin.o libffmpegplugin.cpp

$(OBJECTS_DIR)/libffmpegpluginimpl.o: libffmpegpluginimpl.cpp \
		libffmpegplugin.h \
		$(QPEDIR)/src/3rdparty/libraries/libavcodec/avcodec.h \
		$(QPEDIR)/src/3rdparty/libraries/libavcodec/common.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/config.h \
		$(QPEDIR)/src/3rdparty/libraries/libavcodec/fastmemcpy.h \
		$(QPEDIR)/src/3rdparty/libraries/libavcodec/bswap.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/avformat.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/avio.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/rtp.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/rtsp.h \
		$(QPEDIR)/src/3rdparty/libraries/libavformat/rtspcodes.h \
		yuv2rgb.h \
		libffmpegpluginimpl.h
	$(CXX) -c $(CXXFLAGS) $(INCPATH) -o $(OBJECTS_DIR)/libffmpegpluginimpl.o libffmpegpluginimpl.cpp


