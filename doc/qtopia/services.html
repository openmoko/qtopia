<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- /home/ianw/dev/packages/qtopia/1.6/tmp31015/qtopia/doc/services.doc:1 -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css"><!--
h3.fn,span.fn { margin-left: 1cm; text-indent: -1cm; }
a:link { color: #004faf; text-decoration: none }
a:visited { color: #672967; text-decoration: none }
body { background: #ffffff; color: black; }
--></style>
</head>
<body>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr bgcolor="black"><td>
|<a href="classes.html">
<font color="white">Classes</font></a>
<font color="white">|</font>
<a href="functions.html"><font color="white">Functions</font></a>
<font color="white">|</font>
<a href="../qt/index.html"><font color="white">Qt API</font></a>
</td>
<td align="right"><a href="../index.html"><font color="white"><i>Qtopia Documentation</i></font></a></td>
<td align="right" valign="center"><img src="logo32.png" align="right" width="64" height="32" border="0"></td></tr></table>
<p> 
<p> <h2> Qtopia - Application Services
</h2>
<a name="1"></a><p> Application Services are standardized APIs to functionality
supplied by applications. The purpose is to allow applications
to invoke the services of other application, yet allow the end-user
to decide which application provides which service if more than
one application is available.
<p> Each Service must be very carefully specified. Application developers
should avoid using any service that is not well specified, so as to
avoid limiting the choices available to end-users.
<p> <h3> Qtopia - Requesting Services
</h3>
<a name="1-1"></a><p> To request a service, the calling application executes:
<p> <pre>
    ServiceRequest srv(servicename, action);
    srv &lt;&lt; parameters;
    srv.send();
</pre>
 
<p> For example:
<p> <pre>
    ServiceRequest srv("Email", "writeMail(QString,QString)");
    srv &lt;&lt; QString("Johan R. User") &lt;&lt; QString("random@trolltech.com");
    srv.send();
</pre>
 
<p> ServiceRequest::send() returns a bool value indicating whether the
service is available.
<p> <h3> Qtopia - Providing Services
</h3>
<a name="1-2"></a><p> To provide services, an application must respond to the
<a href="qpeapplication.html#appMessage">QPEApplication::appMessage</a>() signal in the way described
by the service file.
<p> Services files are a $QPEDIR/services/<i>service</i>.service file,
which is a standard Qtopia <a href="config.html">Config</a> file. The keys in this file are:
<p> <ul>
<li> <tt>[Service]</tt>
<ul>
<li> <tt>Name</tt>
<li> <tt>Icon</tt>
<li> <tt>Actions</tt>
<p>
This is a list of actions separated by semicolon (;). The actions
include any formal parameters in parantheses, including the case
of no parameters.
</ul>
<li> <tt>[</tt><i>action</i><tt>]</tt>
<p>
For each entry in the Actions list above, there is
a group defining properties of the action.
<ul>
<li> <tt>Name</tt>
<li> <tt>Icon</tt>
</ul>
</ul>
<p> Example:
<p> <pre>
[Service]
Icon = DateBook
Name = Calendar
Name[de] = Termin kalender
Name[hu] = Napt√°r
Name[no] = Avtalebok
Actions=raiseToday()
[raiseToday()]
Name=Show today's events
Icon=today
</pre><p> Applications that provide a given service are designated by a
$QPEDIR/services/<i>service</i>/<i>appname</i> file, where <i>appname</i>
is the application's executable filename.
This file is a standard Qtopia Config file. The keys in this file are:
<p> <ul>
<li> <tt>[Standard]</tt>
<ul>
<li> <tt>Version</tt>
<p>
An integer.
</ul>
<li> <tt>[Extensions]</tt>
<ul>
<li> <tt>Actions</tt>
<p>
Additional actions to those defined by the standard service.
</ul>
<li> <tt>[</tt><i>action</i><tt>]</tt>
<p>
For each entry in the Actions list above, there is
a group defining properties of the action.
<ul>
<li> <tt>Name</tt>
<li> <tt>Icon</tt>
</ul>
</ul>
<p> <h3> Qtopia - Defined Services
</h3>
<a name="1-3"></a><p> The services below are defined by Trolltech as basic services
that may be available on a Qtopia device, and the messages which
such services handle.
<p> <ul>
<li> Email
<ul>
<li> writeMail(QMap(QString,QString) <i>values</i>)
<ul>
<li> <i>values</i> = set of header names -&gt; value mappings (eg. names are "To", "Subject"),
plus optionally a "BODY" -&gt; value mapping giving the body content, plus optionally
a "ATTACHMENT&lt;n&gt;" -> value mapping. The attachments value is ...
</ul>
In response to this message, the Email service interacts with the
user to complete the email message, and then, if confirmed by the
user, send the email message.
<li> writeMail(QString <i>name</i>,QString <i>email</i>)
<ul>
<li> <i>name</i> = the name of the recipient, or the empty string.
<li> <i>email</i> = the email address of the recipient.
</ul>
In response to this message, the Email service interacts with the
user to complete the email message, and then, if confirmed by the
user, send the email message.
</ul>
<li> WebAccess
<ul>
<li> openURL(QString <i>url</i>)
<ul>
<li> <i>url</i> = a fully-specified URL
</ul>
In response to this message, the WebAccess service retrieves the
resource specified by the URL and either displays it to the user,
invokes further services to display the resource, or notifies the
user that no facility exists for displaying the resource.
If the resource cannot be retrieved, the WebAccess notifies the user.
<li> retrieveURL(QString <i>url</i>)
<ul>
<li> <i>url</i> = a fully-specified URL
</ul>
In response to this message, the WebAccess service retrieves the
resource specified by the URL, creates a document containing the
resource. Then, if services exist to display the document, the
WebAccess service gives the user the option to display the document.
If the resource cannot be retrieved, the WebAccess notifies the user.
<li> getURL(QString <i>url</i>, QString <i>doclnk</i>)
<ul>
<li> <i>url</i> = a fully-specified URL
<li> <i>doclnk</i> = the filename of a .desktop file
</ul>
In response to this message, the WebAccess service retrieves the
resource specified by the URL, creates a document containing the
resource using the given doclnk as the document link file. The
document is created even if the resource could not be retrieved.
As a result of creating the document, Qtopia will send the
QPE/System linkChanged(QString) message, with the doclnk as the
argument.
</ul>
<li> AddressBook
<ul>
<li> newContact(QMap(QString,QString) <i>values</i>)
<ul>
<li> <i>values</i> = set of key,value pairs
</ul>
The standard keys are:
Title, FirstName, MiddleName, LastName, Suffix, FileAs,
JobTitle, Department, Company, BusinessPhone, BusinessFax, BusinessMobile,
DefaultEmail, Emails,
HomePhone, HomeFax, HomeMobile,
BusinessStreet, BusinessCity, BusinessState, BusinessZip, BusinessCountry, BusinessPager, BusinessWebPage,
Office, Profession, Assistant, Manager,
HomeStreet, HomeCity, HomeState, HomeZip, HomeCountry, HomeWebPage,
Spouse, Gender, Birthday, Anniversary, Nickname, Children,
Notes, Groups.
</ul>
<li> Calendar
<ul>
<li> newEvent(QDateTime <i>start</i>, QDateTime <i>end</i>, QString <i>description</i>, QString <i>notes</i>)
<ul>
<li> <i>start</i> = start time for the event (invalid = use default)
<li> <i>end</i> = start time for the event (invalid = use default)
<li> <i>description</i> = one-line description of the event
<li> <i>notes</i> = detailed notes for the event
</ul>
</ul>
<li> Open/<i>mimetype</i>
<ul>
<li> setDocument(QString <i>document</i>)
</ul>
<li> Receive/<i>mimetype</i>
<ul>
<li> receiveData(QString <i>filename</i>, QString <i>type</i>)
<ul>
<li> <i>filename</i> = name of file containing data
<li> <i>type</i> = MIME type of the data
</ul>
<p>The service should delete the file after reading it.
</ul>
</ul>
<p> All services additionally respond to the following messages:
<p> <ul>
<li> raise()
Bring a user interface for the service to the top of the window stack.
<li> quit()
Remove any user interface for the service. Note that sending this message
when the service is not started will start the service (and immediately
terminate it).
</ul>
<p> 
<!-- eof -->
<p><address><hr><div align=center>
<table width=100% cellspacing=0 border=0><tr>
<td>Copyright &copy; 2001-2002 Trolltech<td><a href="http://www.trolltech.com/trademarks.html">Trademarks</a>
<td align=right><div align=right>Qtopia version 1.6.0</div>
</table></div></address></body>
</html>
