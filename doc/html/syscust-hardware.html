<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Hardware Configuration</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qpelogo.png" align="left" width="32" height="32" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a>&nbsp;&middot; <a href="classes.html"><font color="#004faf">All&nbsp;Classes</font></a>&nbsp;&middot; <a href="annotated.html"><font color="#004faf">Annotated</font></a>&nbsp;&middot; <a href="functions.html"><font color="#004faf">Functions</font></a></td>
<td align="right" valign="top" width="230"><img src="images/trolltech-logo.png" align="right" width="203" height="32" border="0" /></td></tr></table><h1 align="center">Hardware Configuration<br /><small></small></h1>
<a name="top"></a><ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#device-specific-code">Device-specific Code</a></li>
</ul>
<a name="introduction"></a>
<h2>Introduction</h2>
<p>When planning to customize and install Qtopia on a specific device a number of a number of factors that must be taken into consideration:</p>
<ul>
<li>If the device has a touch screen, Qtopia calibration must be enabled.</li>
<li>If the device runs off batteries, Qtopia may be required to call APM functions for power saving. See the Power Management section below for more details.</li>
<li>If the device has special hardware buttons, they may need to be mapped to applications and have associated images displayed in the user interface.</li>
<li>If the device has a buzzer for alarms and other beeps, Qtopia will need to know how to use this hardware and enable it for the associated events.</li>
<li>If the device has an LCD screen with a back or front light, Qtopia will need to know how to adjust its brightness.</li>
<li>If the device has any special LEDs to indicate status to the user, Qtopia will need to know how to set the LEDs.</li>
<li>If the device has or supports phone hardware, a serial device that supports GSM AT-commands should be provided, so that Qtopia Phone can use it.</li>
<li>If the device supports sound, the sound volume should be locked to the maximum intended volume.</li>
</ul>
<p>All the changes required to add these device specific customizations are centralized in Qtopia and involve a small number of files (described below). This document should make it easy for OEMs and system integrators to understand how to make Qtopia aware of any special hardware that a device might have.</p>
<a name="devicespecific"></a><a name="device-specific-code"></a>
<h2>Device-specific Code</h2>
<p>During configure, the <tt>-xplatform</tt> option is used to select which <tt>custom-&lt;platform-spec&gt;.h</tt> file will be used when compiling Qtopia.</p>
<p>The following macros can be defined or undefined in a <tt>custom.h</tt> file to customize Qtopia for the specific hardware. The associated <tt>custom-&lt;platform-spec&gt;.cpp</tt> file will be compiled and linked to provide any custom functions that are required.</p>
<p><table align="center" cellpadding="2" cellspacing="1" border="0">
<thead><tr valign="top" class="qt-style"><th>Macro Name</th><th>description</th></tr></thead>
<tr valign="top" class="odd"><td><tt>QPE_USE_MALLOC_FOR_NEW</tt></td><td>#define this to have memory allocated using <tt>malloc()</tt> instead of the default C++ new implementation (this is faster in some cases).</td></tr>
<tr valign="top" class="even"><td><tt>QPE_NEED_CALIBRATION</tt></td><td>#define this if there is a touch screen that requires calibration.</td></tr>
<tr valign="top" class="odd"><td><tt>QPE_OWNAPM</tt></td><td><tt>#define</tt> this if the device has existing APM settings that must be disabled first by Qtopia via ioctls to <tt>/dev/apm_bios</tt>.</td></tr>
<tr valign="top" class="even"><td><tt>QPE_HAVE_MEMALERTER</tt></td><td><tt>#define</tt> this if the device needs Qtopia to alert the user of low memory conditions. A low memory situation will either be triggered/detected by <tt>initMemalerter()</tt> (if <tt>QPE_MEMALERTER_IMPL</tt> is defined) or Qtopia will use its own default implementation.</td></tr>
<tr valign="top" class="odd"><td><tt>QPE_MEMALERTER_IMPL</tt></td><td><tt>#define</tt> this as a macro that implements any functions required to implement the <tt>MEMALERTER</tt> functionality (including <tt>initMemalerter()</tt>).</td></tr>
<tr valign="top" class="even"><td><tt>QPE_INITIAL_NUMLOCK_STATE</tt></td><td><tt>#define</tt> this as a macro that implements any device specific methods used to initialize the numlock state.</td></tr>
<tr valign="top" class="odd"><td><tt>QPE_ARCHITECTURE</tt></td><td>#define this with a string that contains the manufacturer and model that uniquely identifies the device, for example <i>SHARP/SL5500</i>.</td></tr>
<tr valign="top" class="even"><td><tt>QPE_DEFAULT_TODAY_MODE</tt></td><td><tt>#define</tt> this as <i>Daily</i> or <i>Never</i> (including the quotes) to tell Qtopia if by default it should run the today program daily or never.</td></tr>
<tr valign="top" class="odd"><td><tt>QPE_SYSTEM_SYSFILEMONITOR</tt></td><td><tt>#define</tt> this if your device's HotPlug system for Removable Storage Cards is Qtopia-aware.</td></tr>
<tr valign="top" class="even"><td><tt>QPE_SYNC_CLOCK_FROM_QD</tt></td><td>Datebook on Qtopia Desktop sends the <i>current time</i> to Qtopia after it has finished synchronizing. <tt>#define</tt> this to make Qtopia set it's clock from the time received so that the clock on the PDA is kept in sync with the desktop.</td></tr>
<tr valign="top" class="odd"><td><tt>CUSTOM_LEDS(led, status)</tt></td><td><tt>#define</tt> this as a macro which can set an LED to a given status if applicable. The first argument specifies which LED, and the status is an integer with device specific meaning.</td></tr>
<tr valign="top" class="even"><td><tt>QTOPIA_ENABLE_EXPORTED_BACKGROUNDS</tt></td><td><tt>#define</tt> this to have the phone homescreen background used as the background for the launcher.</td></tr>
<tr valign="top" class="odd"><td><tt>QTOPIA_ENABLE_GLOBAL_BACKGROUNDS</tt></td><td><tt>#define</tt> this to have the phone homescreen background used as the background for all applications. Requires <tt>QTOPIA_ENABLE_EXPORTED_BACKGROUNDS</tt>.</td></tr>
<tr valign="top" class="even"><td><tt>QTOPIA_USE_QSS_VOLUME</tt></td><td><tt>#define</tt> this to set the system sound level through QSS rather than modifying <tt>/dev/mixer</tt> (for PDA Edition).</td></tr>
</table></p>
<p>In addition to the above macros and defines, the following three functions must be implemented in the <tt>custom-&lt;platform-spec&gt;.cpp</tt> file.</p>
<p><table align="center" cellpadding="2" cellspacing="1" border="0">
<thead><tr valign="top" class="qt-style"><th>Function Name</th><th>Description</th></tr></thead>
<tr valign="top" class="odd"><td><tt>int qpe_sysBrightnessSteps();</tt></td><td>This function is called by Qtopia to query the number of graduations the device's LCD backlight/frontlight has.</td></tr>
<tr valign="top" class="even"><td><tt>void qpe_setBrightness(int);</tt></td><td>This function must be implemented with any device specific code used to set the backlight/frontlight brightness to the specified level.</td></tr>
<tr valign="top" class="odd"><td><tt>void PowerStatusManager::getStatus();</tt></td><td>This function must be implemented to query the power status. The <tt>PowerStatus</tt> class in <tt>qtopia/power.h</tt> defines the power status abstraction. See the <tt>custom-linux-generic-g++.cpp</tt> file for details of a default implementation.</td></tr>
</table></p>
<p>For reference implementations of the device specific code, the existing <tt>custom-*.*</tt> files found in <tt>src/libraries/qtopia/</tt> may be of assistance.</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td width="30%">Copyright &copy; 2007 <a href="trolltech.html">Trolltech</a></td>
<td width="40%" align="center"><a href="trademarks.html">Trademarks</a></td>
<td width="30%" align="right"><div align="right">Qtopia 4.2.1</div></td>
</tr></table></div></address></body>
</html>
