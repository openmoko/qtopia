<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Qtopia - Optimization using the main() function</title>
<style type="text/css"><!--
h3.fn,span.fn { margin-left: 1cm; text-indent: -1cm; }
a:link { color: #004faf; text-decoration: none }
a:visited { color: #672967; text-decoration: none }
body { background: #ffffff; color: black; }
--></style>
</head>
<body>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top"><a href="index.html"><img height="27" width="472" src="dochead.png" border="0"></a><br>
<font face="Arial,Helvetica,Geneva,Swiss,SunSans-Regular" align="center" size=32>Qtopia</font>
   <a href="index.html">Home</a>
 - <a href="qtopiaclasses.html">Classes</a>
 - <a href="qtopiahierarchy.html">Hierachy</a>
 - <a href="qtopiaannotated.html">Annotated</a>
 - <a href="qtopiafunctions.html">Functions</a>
 - <a href="qtindex.html">Qt Embedded</a>
</td>
<td align="right" valign="top">
  <img height="100" width="100" src="qpelogo.png" align="top" border="0">
</td>
</tr>
</table><h1 align=center>Qtopia - Optimization using the main() function</h1>


<p> 
<p> <a name="top"></a>
<p> <!-- toc -->
<ul>
<li><a href="#1"> Introduction
</a>
<ul>
<li><a href="#1-1"> Enabling Quicklaunching
</a>
</ul>
</ul>
<!-- endtoc -->

<p> <h2> Introduction
</h2>
<a name="1"></a><p> Starting with Qtopia 1.7, it is no longer recommended that the <tt>main()</tt>
function be written explicitly by the programmer.  Instead two macros
are provided to declare the application entry point:
<p> <pre>
QTOPIA_ADD_APPLICATION(NAME,IMPLEMENTATION)
QTOPIA_MAIN
</pre>
 
<p> <tt>QTOPIA_ADD_APPLICATION()</tt> generates code to instantiate the main window,
where NAME is the application executable name and IMPLEMENTATION is the
application window class.
<p> <tt>QTOPIA_MAIN</tt> is either the <tt>main()</tt> implementation or the interface code
necessary to make the application a <em>quicklauncher</em> plugin (if <tt>QTOPIA_APP_INTERFACE</tt> is defined - see below).
<p> The <tt>main.cpp</tt> of all applications should be modeled on
this example:
<p> <pre>
#include "mymainwindow.h"
#include &lt;qtopia/qpeapplication.h&gt;

QTOPIA_ADD_APPLICATION("myapp", MyMainWindow)
QTOPIA_MAIN
</pre>
 
<p> The application window should be implemented in a self-contained way:
it should not perform application-level operations such as testing
parameters, calling exit(), or calling quit(); all of these are
handled by <a href="qpeapplication.html">QPEApplication</a>. Your application window should call close()
if it needs to explicitly close, and it must be prepared for the
possibility that show() will be called again after the close() but
before the application window destructor. In other words, implement
your application window in a way that it could be used easily from
other applications. If you take this approach it will also mean that
most of your program can be trivially reused on Qt/X11, Qt/Windows,
Qt/Mac, and any other ports of the Qt API.
<p> <h3> Enabling Quicklaunching
</h3>
<a name="1-1"></a><p> Starting with Qtopia 1.7, applications can be built as plugins that
can be loaded by the <em>quicklaucher</em>.
The quicklauncher is a stub application that is
pre-loaded and can load an application plugin and change personality to
the plugin application.  The benefit of loading Qtopia applications in this
way is that much of the functionality that the application needs is pre-loaded
and pre-initialised, so the application loading time is significantly
reduced.  Quicklauncher-enabled applications can be run on older Qtopia
platforms by first installing the quicklauncher package.
<p> In order to build an application as a quicklauncher application plugin,
main.cpp must be implemented as above.  Then modify the
qmake project file to build the application as a library and compile
with the plugin interface code enabled by defining <tt>QTOPIA_APP_INTERFACE</tt>),
for example:
<p> <pre>
TEMPLATE = lib
CONFIG  += qtopia
DEFINES += QTOPIA_APP_INTERFACE
HEADERS  = mymainwindow.h
SOURCES  = mymainwindow.cpp main.cpp
TARGET   = myapp
</pre>
 
<p> Application plugins must be installed in <tt>QPEDIR/plugins/application/</tt>.
<p> When building an application as a quicklauncher application plugin it is
important to be careful of symbol collisions.  Because the application 
is compiled as a plugin to be loaded, it is possible for symbols used in
the application to collide with those of the libraries.
<p> For example, if there are two classes of the same name, one in the
application and one in the library the application links to, then it is
possible that when the application is run as a quicklauncher application
the wrong destructor for the class will be called.  This can in turn lead
to memory corruption.
<p> The script <tt>$QPEDIR/scripts/checksymbols</tt> has been provided in order
to help with the identification of possible symbol conflicts.  Make sure QPEDIR is defined
and run the script, passing the .so file created for your application as the
argument.  The script will list possible symbol collision between your
application and the Qtopia libraries.
<p> 
<!-- eof -->
<p><address><hr><div align="center">
<table width="100%" cellspacing="0" border="0">
<tr>
<td>Copyright &copy; 2001-2005 Trolltech
<td><a href="http://www.trolltech.com/trademarks.html">Trademarks</a>
<td align="right"><div align="right">Qtopia version 2.1.1</div>
</table></div></address></body>
</html>
