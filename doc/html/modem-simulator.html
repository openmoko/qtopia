<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Modem Simulator</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qpelogo.png" align="left" width="32" height="32" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a>&nbsp;&middot; <a href="classes.html"><font color="#004faf">All&nbsp;Classes</font></a>&nbsp;&middot; <a href="groups.html"><font color="#004faf">Grouped Classes</font></a>&nbsp;&middot; <a href="annotated.html"><font color="#004faf">Annotated</font></a>&nbsp;&middot; <a href="functions.html"><font color="#004faf">Functions</font></a></td>
<td align="right" valign="top" width="230"><img src="images/trolltech-logo.png" align="right" width="203" height="32" border="0" /></td></tr></table><h1 align="center">Modem Simulator<br /><span class="subtitle"></span>
</h1>
<a name="top"></a><ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#using-the-phone-simulator">Using the Phone Simulator</a></li>
<li><a href="#special-phone-numbers">Special Phone Numbers</a></li>
<li><a href="#gsm-07-10-multiplexing">GSM 07.10 multiplexing</a></li>
<li><a href="#xml-response-file-format">XML Response File Format</a></li>
<li><a href="#sim-application-toolkit-commands">SIM Application Toolkit commands</a></li>
</ul>
<a name="introduction"></a>
<h2>Introduction</h2>
<p>Qtopia provides a Modem Simulator (<tt>phonesim</tt>)to allow testing of telephony applications without the need for access to an actual modem. The simulator provides an AT command channel with responses defined by an XML description.</p>
<p><b>Note:</b> It is preferred that a fully functioning phone be used where possible as <b>phonesim</b> is a simulated tool and not designed as a total replacement for a functioning phone.</p>
<a name="using-the-phone-simulator"></a>
<h2>Using the Phone Simulator</h2>
<p>The command used to run the Phone Simulator is:</p>
<p><tt>phonesim [-p port] filename</tt></p>
<p>where the default <i>port</i> number is 12345 and <i>filename</i> indicates the <a href="#xml-response-file">XML Response file </a> to be used.</p>
<p>To use the Qtopia dialer with the phone simulator, the <tt>QTOPIA_PHONE_DEVICE</tt> environment variable must be set to:</p>
<p><tt>sim:hostname</tt></p>
<p>where <i>hostname</i> is the name of the host where the simulator resides. For most implementations this is set to <tt>localhost</tt>.</p>
<a name="special-phone-numbers"></a>
<h2>Special Phone Numbers</h2>
<p>The Phone Simulator utilizes the following special phone numbers to simulate events:</p>
<p><table align="center" cellpadding="2" cellspacing="1" border="0">
<thead><tr valign="top" class="qt-style"><th>Phone Number</th><th>Function</th></tr></thead>
<tr valign="top" class="odd"><td><b>199</b></td><td>Initiate a <i>Dial Back</i>, that is, the simulator will immediately hang-up and then dial the user back after a delay of a few seconds. This is used to test incoming connections in a single-user environment.</td></tr>
<tr valign="top" class="even"><td><b>199</b></td><td>Reflect outgoing SMS messages back into the incoming message queue.</td></tr>
<tr valign="top" class="odd"><td><b>177</b></td><td>Simulate a missed call but intiating a dial back and hanging up after a number of retries.</td></tr>
<tr valign="top" class="even"><td><b>166</b></td><td>Simulate a bad phone number or bad connection by making and outgoing call that does not connect.</td></tr>
</table></p>
<a name="gsm-07-10-multiplexing"></a>
<h2>GSM 07.10 multiplexing</h2>
<p>The Phone Simulator for the 2.x series of Qtopia Phone Editions includes support for GSM 07.10 multiplexing, that is, AT+CMUX. This removes the requirement for two phone simulator connections to emulate the high-priority and low-priority command channels. The channels will share the same state and state modification commands on one channel will affect the answer on the other channel, which is not the case with dual connections.</p>
<p>To use multiplexing set the following environment variable:</p>
<p><tt>export QTOPIA_PHONE_DEVICE=sim:localhost</tt></p>
<p>The environment variable <tt>QTOPIA_PHONE_DEVICE_LOW</tt> no longer needs to be set.</p>
<p><b>Note: </b> If both environment variables are set, the simulator will use separate connections rather than GSM 07.10 multiplexing.</p>
<a name="xml-response-file"></a><a name="xml-response-file-format"></a>
<h2>XML Response File Format</h2>
<p>Phone Simulator responses are defined by an XML file (for example, troll.xml) with the following format:</p>
<p><table align="center" cellpadding="2" cellspacing="1" border="0">
<thead><tr valign="top" class="qt-style"><th>tag</th><th>description</th></tr></thead>
<tr valign="top" class="odd"><td>&lt;simulator&gt;</td><td>Root element for the XML document.</td></tr>
<tr valign="top" class="even"><td>&lt;state name=&quot;X&quot;&gt;</td><td>Define commands that only apply in a specific state.</td></tr>
<tr valign="top" class="odd"><td>&lt;chat&gt;</td><td>(child of top-level or &lt;state&gt;) Define a chat command/response sequence. A top-level &lt;chat&gt; applies to all states unless there is a state-specific override.</td></tr>
<tr valign="top" class="even"><td>&lt;command&gt;</td><td>(child of &lt;chat&gt;) Contains the text of the command to respond to. The wildcard character &quot;*&quot; at the end of the text can be used to match everything starting with a specific prefix.</td></tr>
<tr valign="top" class="odd"><td>&lt;response delay=&quot;N&quot; eol=&quot;true|false&quot;&gt;</td><td>(child of &lt;chat&gt;) Contains the text of the response, with an optional delay prior to sending it back to the client. The delay is in milliseconds. The sequence &quot;${X}&quot; can be used in a response to indicate &quot;substitute the value of script variable X&quot;. If &quot;eol&quot; is &quot;true&quot; (the default), then the response will be followed by an end-of-line sequence.</td></tr>
<tr valign="top" class="even"><td>&lt;switch name=&quot;X&quot;/&gt;</td><td>(child of &lt;chat&gt;) Switch into the specified state after issuing the response. An unspecified state name indicates to return to the top-level state. The name &quot;default&quot; can be used to switch back to the default state.</td></tr>
<tr valign="top" class="odd"><td>&lt;unsolicited delay=&quot;N&quot; switch=&quot;X&quot;&gt;</td><td>(child of top-level or &lt;state&gt;) Indicates an unsolicited response to issue to the client after &quot;N&quot; milliseconds after switching into the current state. The optional &quot;switch&quot; tells the simulator to enter the specified state after sending the unsolicited response (e.g&#x2e; an unsolicited RING may put the simulator into a different state from the default). The sequence &quot;${X}&quot; can be used in a response to indicate &quot;substitute the value of script variable X&quot;.</td></tr>
<tr valign="top" class="even"><td>&lt;set name=&quot;X&quot; value=&quot;Y&quot;/&gt;</td><td>(child of top-level or &lt;chat&gt;) When used at the top level, this sets the default value of a script variable called &quot;X&quot; to &quot;Y&quot;. When used within a &lt;chat&gt; element, this will set the value of the script variable &quot;X&quot; when the &lt;chat&gt;'s command is successfully matched. The value &quot;*&quot; can be used for the &quot;*&quot; part of a prefix command match. This allows parameter information to be copied from a command into a variable.</td></tr>
<tr valign="top" class="odd"><td>&lt;start name=&quot;X&quot;/&gt;</td><td>Starting state, if not the same as the top-level state.</td></tr>
<tr valign="top" class="even"><td>&lt;newcall name=&quot;VAR&quot;/&gt;</td><td>Allocate a new call identifier and put its number into &quot;VAR&quot;.</td></tr>
<tr valign="top" class="odd"><td>&lt;forgetcall id=&quot;ID&quot;/&gt;</td><td>Forget a call with identifier &quot;ID&quot;, freeing up the identifier to be allocated to a new call.</td></tr>
<tr valign="top" class="even"><td>&lt;toolkit&gt;</td><td>Define a program for the SIM Application Toolkit part of the simulator.</td></tr>
</table></p>
<a name="sim-application-toolkit-commands"></a>
<h2>SIM Application Toolkit commands</h2>
<p>The &lt;toolkit&gt; tag is used to define a simple program to simulate an application running inside the SIM.</p>
<p><table align="center" cellpadding="2" cellspacing="1" border="0">
<thead><tr valign="top" class="qt-style"><th>tag</th><th>description</th></tr></thead>
<tr valign="top" class="odd"><td>&lt;label name=&quot;NAME&quot;/&gt;</td><td>Define a program label, that can be used as the destination for &lt;goto&gt;, &lt;gosub&gt;, and similar commands.</td></tr>
<tr valign="top" class="even"><td>&lt;goto name=&quot;NAME&quot;/&gt;</td><td>Jump to the point in the program that is defined by the label &quot;NAME&quot;.</td></tr>
<tr valign="top" class="odd"><td>&lt;gosub name=&quot;NAME&quot;/&gt;</td><td>Set the return location to the current point in the program and then jump to the point in the program that is defined by the label &quot;NAME&quot;. Only one level of subroutine is currently supported.</td></tr>
<tr valign="top" class="even"><td>&lt;return&gt;</td><td>Return from the current subroutine.</td></tr>
<tr valign="top" class="odd"><td>&lt;set name=&quot;NAME&quot; value=&quot;VALUE&quot;/&gt;</td><td>Set the variable called &quot;NAME&quot; to &quot;VALUE&quot;. If &quot;VALUE&quot; contains a term of the form &quot;${X}&quot;, then the contents of the variable &quot;X&quot; will be inserted at that position.</td></tr>
<tr valign="top" class="even"><td>&lt;ifeq var=&quot;NAME&quot; value=&quot;VALUE&quot; goto=&quot;LABEL&quot;/&gt;</td><td>Compare the contents of the variable &quot;NAME&quot; with &quot;VALUE&quot; and then jump to &quot;LABEL&quot; if they are the same.</td></tr>
<tr valign="top" class="odd"><td>&lt;ifne var=&quot;NAME&quot; value=&quot;VALUE&quot; goto=&quot;LABEL&quot;/&gt;</td><td>Compare the contents of the variable &quot;NAME&quot; with &quot;VALUE&quot; and then jump to &quot;LABEL&quot; if they are not the same.</td></tr>
<tr valign="top" class="even"><td>&lt;eval var=&quot;NAME&quot; left=&quot;LEFT&quot; op=&quot;OPERATOR&quot; right=&quot;RIGHT&quot;/&gt;</td><td>Evaluate an arithmetic expression and place the result into the variable &quot;NAME&quot;. &quot;OPERATOR&quot; may be one of &quot;+&quot;, &quot;-&quot;, &quot;*&quot;, &quot;/&quot;, &quot;%&quot;, &quot;&amp;&quot;, &quot;|&quot;, &quot;^&quot;, &quot;~&quot;, &quot;&lt;&lt;&quot;, }{&gt;&quot;, &quot;&amp;&amp;&quot;, &quot;||&quot;, &quot;!&quot;, or &quot;concat&quot;.</td></tr>
<tr valign="top" class="odd"><td>&lt;mainmenu title=&quot;TITLE&quot;&gt;</td><td>Define the main program menu with the given &quot;TITLE&quot;.</td></tr>
<tr valign="top" class="even"><td>&lt;menu title=&quot;TITLE&quot; default=&quot;ITEM&quot; [back=&quot;LABEL&quot;]&gt;</td><td>Define a program menu with the given &quot;TITLE&quot; and default &quot;ITEM&quot;. When the user selects &quot;Back&quot;, the program will jump to &quot;LABEL&quot;.</td></tr>
<tr valign="top" class="odd"><td>&lt;item id=&quot;ID&quot; name=&quot;NAME&quot; [help=&quot;HELPLABEL&quot;] goto=&quot;LABEL&quot;/&gt;</td><td>Define an item within a &lt;mainmenu&gt; or &lt;menu&gt; element. &quot;ID&quot; is a numeric value that identifies the item; &quot;NAME&quot; is the text name to display on the user's screen; &quot;HELPLABEL&quot; is a label to jump to if the user selects &quot;Help&quot; for the item; and &quot;LABEL&quot; is the regular label to jump to when the user selects the item.</td></tr>
<tr valign="top" class="even"><td>&lt;displaytext [autoclear=&quot;CLEAR&quot;] [highpriority=&quot;HIGH&quot;&gt;TEXT&lt;/displaytext&gt;</td><td>Display &quot;TEXT&quot; on the user's screen. If &quot;CLEAR&quot; is &quot;true&quot;, then automatically clear the text after 3 seconds. If &quot;HIGH&quot; is &quot;true&quot;, then the text should be displayed with high priority.</td></tr>
<tr valign="top" class="odd"><td>&lt;getkey type=&quot;TYPE&quot; [help=&quot;LABEL&quot;]/&gt;</td><td>Ask the user for a single keypress. &quot;TYPE&quot; may be one of &quot;digit&quot;, &quot;alpha&quot;, or &quot;ucs2&quot;. If the user selects &quot;Help&quot;, then the program will jump to &quot;LABEL&quot;.</td></tr>
<tr valign="top" class="even"><td>&lt;getinput type=&quot;TYPE&quot; [help=&quot;LABEL&quot;] [echo=&quot;ECHO&quot;] [minlength=&quot;MIN&quot;] [maxlength=&quot;MAX&quot;]/&gt;</td><td>Ask the user for a line of input. &quot;TYPE&quot; may be one of &quot;digit&quot;, &quot;alpha&quot;, or &quot;ucs2&quot;. If the user selects &quot;Help&quot;, then the program will jump to &quot;LABEL&quot;. If &quot;ECHO&quot; is &quot;false&quot;, then the characters will not be echoed to the screen (e.g&#x2e; for passwords). &quot;MIN&quot; and &quot;MAX&quot; define the minimum and maximum text lengths (1 and 255 by default, respectively).</td></tr>
<tr valign="top" class="odd"><td>&lt;setupcall number=&quot;NUMBER&quot; [subAddress=&quot;SUBADDR&quot;] [othercalls=&quot;OTHER&quot;] [class=&quot;CLASS&quot;]/&gt;</td><td>Ask the phone to set up a phone call to &quot;NUMBER&quot; (extension &quot;SUBADDR&quot;). &quot;OTHER&quot; should be one of &quot;notbusy&quot; (the default), &quot;hold&quot;, or &quot;hangup&quot;. &quot;notbusy&quot; indicates that the call should only be attempted if the user is not busy on another call. &quot;hold&quot; indicates that all other calls should be placed on hold. &quot;hangup&quot; indicates that all other calls should be hung up first. &quot;CLASS&quot; should be one of &quot;voice&quot; (the default), &quot;data&quot;, or &quot;fax&quot;.</td></tr>
<tr valign="top" class="even"><td>&lt;play tone=&quot;TONE&quot; [interval=&quot;INTERVAL&quot;]/&gt;</td><td>Play the given &quot;TONE&quot; for &quot;INTERVAL&quot; milliseconds. &quot;TONE&quot; should be one of &quot;dial&quot;, &quot;busy&quot;, &quot;congestion&quot;, &quot;radio ack&quot;, &quot;dropped&quot;, &quot;error&quot;, &quot;call waiting&quot;, &quot;ringing&quot;, &quot;general beep&quot;, &quot;positive beep&quot;, or &quot;negative beep&quot;. If the interval is not supplied, it defaults to 1 second.</td></tr>
<tr valign="top" class="odd"><td>&lt;refresh type=&quot;TYPE&quot;/&gt;</td><td>Inform the phone that a refresh has occurred. &quot;TYPE&quot; should be one of &quot;init and full file change&quot;, &quot;file change&quot;, &quot;init and file change&quot;, &quot;initialization&quot;, or &quot;reset&quot;.</td></tr>
<tr valign="top" class="even"><td>&lt;sendss&gt;TEXT&lt;/sendss&gt;</td><td>Tell the user with the message &quot;TEXT&quot; that a supplementary service (SS) change is in progress.</td></tr>
<tr valign="top" class="odd"><td>&lt;sendsms&gt;TEXT&lt;/sendsms&gt;</td><td>Tell the user with the message &quot;TEXT&quot; that an SMS message is being sent.</td></tr>
<tr valign="top" class="even"><td>&lt;sendussd&gt;TEXT&lt;/sendussd&gt;</td><td>Tell the user with the message &quot;TEXT&quot; that Unstructured Supplementary Service Data (USSD) is being sent.</td></tr>
<tr valign="top" class="odd"><td>&lt;setupeventlist type=&quot;TYPE&quot;/&gt;</td><td>Setup event reporting according to &quot;TYPE&quot;, which should be one of &quot;idle&quot;, &quot;user&quot;, &quot;idle and user&quot;, or &quot;cancel&quot;.</td></tr>
</table></p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2007 <a href="trolltech.html">Trolltech</a></td>
<td align="center"><a href="trademarks.html">Trademarks</a></td>
<td align="right"><div align="right">Qtopia 4.2.4</div></td>
</tr></table></div></address></body>
</html>
