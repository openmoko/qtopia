<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Optimization Using main()</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qpelogo.png" align="left" width="32" height="32" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a>&nbsp;&middot; <a href="classes.html"><font color="#004faf">All&nbsp;Classes</font></a>&nbsp;&middot; <a href="groups.html"><font color="#004faf">Grouped Classes</font></a>&nbsp;&middot; <a href="annotated.html"><font color="#004faf">Annotated</font></a>&nbsp;&middot; <a href="functions.html"><font color="#004faf">Functions</font></a></td>
<td align="right" valign="top" width="230"><img src="images/trolltech-logo.png" align="right" width="203" height="32" border="0" /></td></tr></table><h1 align="center">Optimization Using main()<br /><span class="subtitle"></span>
</h1>
<a name="top"></a><ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#enabling-quick-launching">Enabling Quick Launching</a></li>
</ul>
<a name="introduction"></a>
<h2>Introduction</h2>
<p>It is no longer recommended that the <tt>main()</tt> function be written explicitly by the programmer. Instead two macros are provided to declare the application entry point:</p>
<pre>    QTOPIA_ADD_APPLICATION(NAME,IMPLEMENTATION)
    QTOPIA_MAIN</pre>
<p><tt>QTOPIA_ADD_APPLICATION()</tt> generates code to instantiate the main window, where <tt>NAME</tt> is the application executable name and <tt>IMPLEMENTATION</tt> is the application window class. Qtopia adds a <tt>QTOPIA_TARGET</tt> define that is the value of TARGET from your <tt>.pro</tt> file which makes synchronizing the <i>name</i> and the <tt>TARGET</tt> trivial.</p>
<p><tt>QTOPIA_MAIN</tt> is either the <tt>main()</tt> implementation or the interface code necessary to make the application a <i>quicklauncher</i> plug-in.</p>
<p>The <tt>main.cpp</tt> of all applications should be modeled on this example:</p>
<pre>    #include &quot;mymainwindow.h&quot;
    #include &lt;qtopia/qtopiaapplication.h&gt;

    QTOPIA_ADD_APPLICATION(QTOPIA_TARGET, MyMainWindow)
    QTOPIA_MAIN</pre>
<p>The application window should be implemented in a self-contained way: it should not perform application-level operations such as testing parameters, calling exit(), or calling quit(); all of these are handled by <a href="qtopiaapplication.html">QtopiaApplication</a>. Your application window should call close() if it needs to explicitly close, and it must be prepared for the possibility that show() will be called again after the close() but before the application window destructor. In other words, implement your application window in a way that it could be used easily from other applications. If you take this approach it will also mean that most of your program can be trivially reused on Qt/X11, Qt/Windows, Qt/Mac, and any other ports of the Qt API.</p>
<a name="enabling-quick-launching"></a>
<h2>Enabling Quick Launching</h2>
<p>If quick launching is enabled, then all Applications are built as <tt>quicklauncher</tt> plug-ins unless they have the following in their <tt>.pro</tt> file.</p>
<pre>    CONFIG+=no_quicklaunch</pre>
<p>When building an application as a <tt>quicklauncher</tt> application plug-in it is important to be careful of symbol collisions. Since the application is compiled as a plug-in to be loaded, it is possible for symbols used in the application to collide with those of the libraries.</p>
<p>For example, if there are two classes of the same name, one in the application and one in the library the application links to, then it is possible that when the application is run as a <tt>quicklauncher</tt> application the wrong destructor for the class will be called. This can in turn lead to memory corruption.</p>
<p>The script <tt>$QPEDIR/scripts/checksymbols</tt> is provided to help with the identification of possible symbol conflicts. Make sure <tt>QPEDIR</tt> is defined and run the script, passing the <tt>.so</tt> file created for your application as the argument. The script will list possible symbol collision between your application and the Qtopia libraries.</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2007 <a href="trolltech.html">Trolltech</a></td>
<td align="center"><a href="trademarks.html">Trademarks</a></td>
<td align="right"><div align="right">Qtopia 4.2.4</div></td>
</tr></table></div></address></body>
</html>
