<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Managing Memory Usage</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qpelogo.png" align="left" width="32" height="32" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a>&nbsp;&middot; <a href="classes.html"><font color="#004faf">All&nbsp;Classes</font></a>&nbsp;&middot; <a href="groups.html"><font color="#004faf">Grouped Classes</font></a>&nbsp;&middot; <a href="annotated.html"><font color="#004faf">Annotated</font></a>&nbsp;&middot; <a href="functions.html"><font color="#004faf">Functions</font></a></td>
<td align="right" valign="top" width="230"><img src="images/trolltech-logo.png" align="right" width="203" height="32" border="0" /></td></tr></table><h1 align="center">Managing Memory Usage<br /><span class="subtitle"></span>
</h1>
<a name="shared-memory-cache"></a>
<h2>Shared Memory Cache</h2>
<p>Qtopia performs adequately with 64 Mb RAM; however a system using half this amount on say, shared memory cache and backing store will not have acceptable performance. A constant: <tt>QGLOBAL_PIXMAP_CACHE_LIMIT</tt> is provided to aid memory management for systems with large, high bit per pixel(bpp) screens and is defined in <tt>src/libraries/qtopiabase/qglobalpixmapcache.h</tt> as follows:</p>
<pre>    #define QGLOBAL_PIXMAP_CACHE_LIMIT 1048576</pre>
<p>This constant determines the size of the shared memory cache that Qtopia uses and depends on the user device. The shared memory cache holds pixmaps that are common between applications with the most important being the background image. The size of the background image depends on the size and depth of the screen, for example:</p>
<ul>
<li>the Greenphone is 240x320x16 bpp which means it requires 150 Kb to store the background image</li>
<li>a system with a 640x480x32 bpp screen requires 1.2 Mb to store the background which is greater than the constant as defined above, so it will fail and Qtopia will crash.</li>
</ul>
<p>Considering that more than just the background image is in the shared memory cache, for example, it also holds other images and potentially font information, the shared memory buffer must be resized relative to the size of the background image. So, for example, a 640x480x32 bpp system needs to allocate 12 Mb to the shared memory cache. A potential rule-of-thumb is that a shared memory cache needs twice as large as the background image should suffice, however it may reduce the potential benefit.</p>
<a name="free-utility"></a>
<h2>free Utility</h2>
<p>Memory usage can be determined by using the <tt>free</tt> utility with cached memory considered to be free. By running <tt>qpe</tt> with memory options specified memory usage can be reduced and overall performance increased.</p>
<p>For example, specifying:</p>
<pre>    -fontfamilies helvetica -iconsizes 14 -languages en_US</pre>
<p>without options results in <tt>qpe</tt> using 12M, however with options <tt>qpe</tt> uses 7.3M.</p>
<p>Removing applications that are not required will also increase startup and performance as the number of icons to load into memory is decreased.</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2007 <a href="trolltech.html">Trolltech</a></td>
<td align="center"><a href="trademarks.html">Trademarks</a></td>
<td align="right"><div align="right">Qtopia 4.2.4</div></td>
</tr></table></div></address></body>
</html>
