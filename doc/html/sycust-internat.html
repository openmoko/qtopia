<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Internationalization</title>
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qpelogo.png" align="left" width="32" height="32" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a>&nbsp;&middot; <a href="classes.html"><font color="#004faf">All&nbsp;Classes</font></a>&nbsp;&middot; <a href="annotated.html"><font color="#004faf">Annotated</font></a>&nbsp;&middot; <a href="functions.html"><font color="#004faf">Functions</font></a></td>
<td align="right" valign="top" width="230"><img src="images/trolltech-logo.png" align="right" width="203" height="32" border="0" /></td></tr></table><h1 align="center">Internationalization<br /><small></small></h1>
<a name="top"></a><ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#translating-qtopia">Translating Qtopia</a></li>
<ul><li><a href="#install-qt-4-x">Install Qt 4.x</a></li>
<li><a href="#getting-started-translating">Getting Started Translating</a></li>
<li><a href="#language-description">Language Description</a></li>
<li><a href="#translating-qtopia-using-linguist">Translating Qtopia using Linguist</a></li>
<li><a href="#installing-translation-files">Installing Translation Files</a></li>
</ul>
<li><a href="#fonts">Fonts</a></li>
<li><a href="#program-internationalization">Program Internationalization</a></li>
<ul><li><a href="#placing-application-files">Placing Application Files</a></li>
<li><a href="#placing-plug-in-files">Placing Plug-in Files</a></li>
</ul>
<li><a href="#desktop-configuration-file-internationalization">Desktop &amp; Configuration File Internationalization</a></li>
<li><a href="#image-translation">Image Translation</a></li>
<li><a href="#documentation-internationalization">Documentation Internationalization</a></li>
<li><a href="#other-internationalization-files">Other Internationalization Files</a></li>
<li><a href="#translating-your-own-applications">Translating Your Own Applications</a></li>
</ul>
<a name="introduction"></a>
<h2>Introduction</h2>
<p>Qtopia can be translated into several languages. By default Qtopia ships only with English. Additional language-specific packages are available for purchase. For further information please contact <a href="mailto:sales@trolltech.com">sales@trolltech.com</a> .</p>
<p>Internationalizing Qtopia software is much the same as internationalizing any Qt-based software. You should be familiar with the <a href="i18n.html">Qt internationalization documentation</a> , the <tt>tr()</tt> macros, <a href="linguist-manual.html">Qt Linguist</a> and the internationalization process in general before you proceed with this document.</p>
<a name="translating-qtopia"></a>
<h2>Translating Qtopia</h2>
<p>Adding a translation for Qtopia is easy. There are a few steps you will need to take in order to successfully translate Qtopia into your chosen language.</p>
<ol type="1">
<li><a href="#install">Install Qt 4.x (for desktops), which includes linguist, lupdate and lrelease.</a></li>
<li><a href="#linguist">Run lupdate and lrelease, and start using Trolltech's linguist</a></li>
<li><a href="#description">Add language description</a></li>
<li><a href="#translate">Translate the strings using the Linguist tool</a></li>
<li><a href="linguist-manager.html#lrelease">Install translation files</a></li>
</ol>
<p>To translate Qtopia into an additional language you must perform the translation process described above for all the application, desktop and configuration files, and any help documentation that you wish to have available in that language.</p>
<a name="install"></a><a name="install-qt-4-x"></a>
<h3>Install Qt 4.x</h3>
<p>You can either install Qt4 for X11 from your linux distribution, or download the <a href="ftp://ftp.trolltech.com/qt/source/">Qt4 source</a> , and compile it yourself. Once installed, you should have linguist, lupdate and lrelease tools available for you to use.</p>
<a name="linguist"></a><a name="getting-started-translating"></a>
<h3>Getting Started Translating</h3>
<p>The first step is to tell Qtopia where Qt4 is installed. This is done by setting the environment variable <tt>DQTDIR</tt> to the location of your Qt4 desktop directory. Not having set this variable will prevent that configure generates the necessary installation rules.</p>
<p>Qtopia ships without any translation files. If you want to generate translation files for your chosen language you have to reconfigure Qtopia:</p>
<p><tt>$QPEDIR/configure -languages &quot;ja fr zh_CN&quot; &lt;other configure options&gt;</tt></p>
<p>This will tell the build system that it has to build translation files for Japanese, French and Simplified Chinese.</p>
<a name="description"></a><a name="language-description"></a>
<h3>Language Description</h3>
<p>Create the directory <tt>$QPEDIR/i18n/&lt;new-lang&gt;</tt> for the new language. Qtopia will save all translation files in this directory. If this directory hasn't been created by the time the command <tt>make lupdate</tt> is executed the build system will create this directory.</p>
<p>Running <tt>make lupdate</tt> will generate server specific translation files(e.g. <tt>QtopiaApplications.ts</tt> which contain the translated names for Qtopia applications) in the above mentioned directory and generates translation files for each language specified via Qtopia's configure option <tt>languages</tt>. The general naming convention for these files is <tt>&lt;appname&gt;-&lt;your-lang&gt;.ts</tt> (e.g. <tt>sysinfo-zh_CN.ts</tt>).</p>
<p>In addition to these automatically generated files every language needs a <tt>.directory</tt> file that serves as a description for the language itself. For example, the German <tt>.directory</tt> in <tt>$QPEDIR/i18n/de</tt> looks like this:</p>
<pre>&nbsp;   [Translation]
    File=QtopiaI18N
    Context=German
    [Desktop Entry]
    Name[]=German</pre>
<p>It contains the name of the language itself as it is presented to the user. To incorporate the new <tt>.directory</tt> file into all translations it is necessary to run make lupdate for a second time. Alternatively you may create the <tt>$QPEDIR/i18n/&lt;your-lang&gt;</tt> directory manually, add the new <tt>.directory</tt> file and run <tt>make lupdate</tt> afterwards.</p>
<p>As the last step of <tt>make lupdate</tt> the script <tt>$QPEDIR/bin/nct_lupdate</tt> is executed in order to generate translation files for those strings that cannot be found in source code. This includes most config and desktop files in the <tt>$QPEDIR</tt> directory. Each of these config/desktop files must have a Translation group similar to the following one which can be found in <tt>$QPEDIR/apps/Applications/clock.desktop</tt>:</p>
<pre>&nbsp;   [Translation]
    File=QtopiaApplications</pre>
<p>This causes the generation of the file <tt>QtopiaApplications.ts</tt> in <tt>$QPEDIR/i18n/&lt;your-lang&gt;</tt>. If this file already exists it will be updated without the loss of any existing content.</p>
<a name="translate"></a><a name="translating-qtopia-using-linguist"></a>
<h3>Translating Qtopia using Linguist</h3>
<p>The next step is to run the linguist tool. Linguist makes it easy to work with translations. It supports incremental translation, which helps you to keep track of any additional content that is added to Qtopia and needs to be translated. Any strings that are ambiguous or otherwise unclear or suspect in some way, should be translated to wahtever degree is possible and then left in the <i>unfinished</i> state.</p>
<p>For further information refer to : <a href="http://doc.trolltech.com/4/linguist-manual.html">Linguist Manual</a> <a name="lrelease"></a></p>
<a name="installing-translation-files"></a>
<h3>Installing Translation Files</h3>
<p>The last step is to run the command <tt>make install</tt> in the Qtopia (<tt>$QPEDIR</tt>) directory. As part of this process lrelease is used to create Qt message files (<tt>.qm</tt> files).</p>
<a name="fonts"></a>
<h2>Fonts</h2>
<p>Qtopia uses Helvetica as the default font, however this font does not specify the characters for languages such as Chinese.</p>
<p>The configuration file <tt>$QPEDIR/etc/default/FontMap.conf</tt> has to be translated so that the correct font family and size is used for each language. It defines the font which can be selected by users within Qtopia. If this configuration file is empty, Qtopia will use Helvetica font as the default font. Therefore, a valid <tt>FontMap.conf</tt> and <tt>QtopiaDefaults.ts</tt> file is required to suppress Helvetica as the preferred choice. The original <tt>FontMap.conf</tt> looks like this:</p>
<pre>&nbsp;   [Translation]
    File=QtopiaDefaults
    Context=FontMap
    [Map]
    Font0[]=small,helvetica,10
    Font1[]=normal,helvetica,12
    Font2[]=large,helvetica,14</pre>
<p>Such a configuration will be suitable for most Western languages. The Map group defines three font settings that will be used by Qtopia, each of which have three parameters as follows:</p>
<ol type="1">
<li>textual string that is presented to the user when a new setting is chosen</li>
<li>font family specification</li>
<li>font size.</li>
</ol>
<p>This configuration file is marked for translation. When executing <tt>make lupdate</tt> the build system will create: <tt>$QPEDIR/i18n/&lt;your-lang&gt;/QtopiaDefaults.ts</tt>. Due to its special meaning, the string &quot;small,helvetica,12&quot; cannot be translated as a normal string, for example, a French translation may look like this:</p>
<pre>&nbsp;   &lt;name&gt;FontMap&lt;/name&gt;
    &lt;message encoding=&quot;UTF-8}{
            &lt;source&gt;Small,helvetica,10&lt;/source&gt;
            &lt;translation&gt;Petit,unifont,11&lt;/translation&gt;
    &lt;/message&gt;</pre>
<p>As a result, <tt>Petit</tt> will be presented to the user and selecting this option will load the fontset <tt>unifont</tt> with a font size of 11. The chosen font has to support all characters of the given language.</p>
<a name="program-internationalization"></a>
<h2>Program Internationalization</h2>
<p>When <tt>make install</tt> is executed the build system generates Qt message files (<tt>.qm</tt> files).</p>
<a name="placing-application-files"></a>
<h3>Placing Application Files</h3>
<p>Application files will be placed as follows:</p>
<p><tt>/opt/Qtopia/i18n/language/&lt;appname&gt;.qm</tt></p>
<p>The <b>language</b> is an ISO 639 language code optionally followed by an underscore and an ISO 3166 territory (for example, &quot;en&quot;, &quot;en_GB&quot;, &quot;ja&quot;, &quot;ja_JP&quot;). Locale suffixes are supported. For example, if your application uses British English it can have a <tt>/opt/Qtopia/i18n/en_US/&lt;appname&gt;.qm</tt> file specifying changes for American English. Translations with locale suffixes take precedence over translations without such suffixes.</p>
<p>The <b>&lt;appname&gt;</b> is the filename of the application executable.</p>
<a name="placing-plug-in-files"></a>
<h3>Placing Plug-in Files</h3>
<p>For plug-ins that are shared libraries the files must be placed in the following directory:</p>
<p><tt>/opt/Qtopia/i18n/language/&lt;pluginname&gt;.qm</tt></p>
<p>The <b>&lt;pluginname&gt;</b> is the filename of the plug-in shared object minus any extensions, but including <i>lib</i> if the plug-in incorporates that prefix.</p>
<a name="desktop-configuration-file-internationalization"></a>
<h2>Desktop &amp; Configuration File Internationalization</h2>
<p>Desktop/Config files (eg. <tt>/opt/Qtopia/apps/Application/&lt;appname&gt;.desktop</tt>) can also be translated. For example, the <tt>texteditor.desktop</tt> file begins with:</p>
<pre>&nbsp;   [Translation]
    File=QtopiaApplications
    Context=Notes
    [Desktop Entry]
    Comment[]=A Text Editing Program
    Exec=textedit
    Icon=TextEditor
    Type=Application
    MimeType=text/*
    Name[]=Notes</pre>
<p>This causes the file <tt>/opt/Qtopia/i18n/language/QtopiaApplications.qm</tt> to be loaded (if it isn't already) and the strings marked with &quot;[]&quot; to be translated in the &quot;Text Editor&quot; context. The &quot;bin/nct_lupdate&quot; script can be used to maintain <tt>.ts</tt> files from <tt>.desktop</tt> files.</p>
<p>All desktop files have to be encoded in UTF-8.</p>
<a name="image-translation"></a>
<h2>Image Translation</h2>
<p>For certain applications it may be a requirement to translate image. A word processor application may have a tool button that markes text as bold. The button itself may have the capital letter B as image. This would not be suitable for e.g. a German user interface where the B would have to be replaced by an image displaying the letter F ('Bold' translates to the German 'Fett').</p>
<p>The resource system supports the following two types of translatable images:</p>
<ul>
<li><tt>QPixmap(&quot;:image/i18n/bold&quot;)</tt></li>
<li><tt>QIcon(&quot;:icon/i18n/bold)</tt></li>
</ul>
<p>The string <tt>i18n</tt> serves as an indicator to activate a lookup mechanism that is aware of the current user interface language. The pixmap above will be looked up in one of the following directories:</p>
<ul>
<li><tt>QPEDIR/pics/&lt;app-name&gt;/i18n/de_DE/bold.png</tt> (app specific translatable pictures)</li>
<li><tt>QPEDIR/pics/i18n/de_DE/bold.png</tt> (global non-translatable pictures)</li>
<li><tt>QPEDIR/pics/&lt;app-name&gt;/i18n/de/bold.png</tt></li>
<li><tt>QPEDIR/pics/i18n/de/bold.png</tt></li>
<li><tt>QPEDIR/pics/&lt;app-name&gt;/i18n/en_US/bold.png</tt> (app specific fall back)</li>
<li><tt>QPEDIR/pics/i18n/en_US/bold.png</tt> (global fallback)</li>
</ul>
<p>As comparison a call to <tt>QPixmap(&quot;:image/bold&quot;)</tt> will search in different directories:</p>
<ul>
<li><tt>QPEDIR/pics/&lt;app-name&gt;/bold.png</tt> (app specific pictures)</li>
<li><tt>QPEDIR/pics/bold.png</tt> (app specific pictures)</li>
</ul>
<p>A picture that requires a translation must be put into one of the i18n subfolders. American English (en_US) is used as a fall back mechanism in case there is no translation for the current language. Therefore developers who want to provide translations for their pictures have to ensure that they provide a translation/picture for American English.</p>
<a name="documentation-internationalization"></a>
<h2>Documentation Internationalization</h2>
<p>Online documentation for applications is written in the HTML subset supported by the Qt richtext widget. Such documentation files must be placed as follows:</p>
<p>English documentation:</p>
<p><tt>/opt/Qtopia/help/html/&lt;appname&gt;-suffixes.html</tt></p>
<p>Non-English documentation:</p>
<p><tt>/opt/Qtopia/help/&lt;lang&gt;/html/&lt;appname&gt;-suffixes.html</tt></p>
<p>These files are encoded in UTF-8.</p>
<a name="other-internationalization-files"></a>
<h2>Other Internationalization Files</h2>
<p>Other files that are language-specific are:</p>
<ul>
<li><tt>/opt/Qtopia/etc/dict/words-&lt;lang&gt;</tt> - list of words in <b>language</b> .</li>
<li><tt>/opt/Qtopia/etc/dict/words-&lt;lang&gt;.dawg</tt> - above, converted to dawg format.</li>
<li><tt>/opt/Qtopia/etc/dict/common-&lt;lang&gt;</tt> - list of common words in <b>language</b> that input methods might conflict with less common words.</li>
<li><tt>/opt/Qtopia/etc/dict/common-&lt;lang&gt;.dawg</tt> - above, converted to dawg format.</li>
</ul>
<a name="translating-your-own-applications"></a>
<h2>Translating Your Own Applications</h2>
<p>The Qtopia build system makes it very easy to translate your own applications. The example application in <tt>$QPEDIR/examples/application</tt> summarizes what has to be done in order to generate <tt>.ts</tt> files. Further details on how to build and install additional Qtopia applications can be found in the <a href="compile-run-examples.html">build system help</a> .</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td width="30%">Copyright &copy; 2007 <a href="trolltech.html">Trolltech</a></td>
<td width="40%" align="center"><a href="trademarks.html">Trademarks</a></td>
<td width="30%" align="right"><div align="right">Qtopia 4.2.2</div></td>
</tr></table></div></address></body>
</html>
